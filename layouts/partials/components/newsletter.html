{{/* Newsletter Signup Component */}}
{{ if .Site.Params.newsletter_url }}
<div class="w-full max-w-md px-2 sm:px-0">
  <form action="{{ .Site.Params.newsletter_url }}" method="post" target="_blank" rel="noopener noreferrer" novalidate>
    <fieldset class="form-control">
      <legend class="label">
        <span class="label-text text-sm sm:text-base font-semibold">Subscribe to my newsletter</span>
      </legend>
      <div class="join flex-col sm:flex-row">
        <label for="newsletter-email" class="sr-only">Email address</label>
        <input
          type="email"
          id="newsletter-email"
          name="EMAIL"
          placeholder="your@email.com"
          class="input input-bordered join-item flex-1 mb-2 sm:mb-0"
          required
          aria-describedby="newsletter-help newsletter-error"
          autocomplete="email"
        />
        <div style="position: absolute; left: -5000px;" aria-hidden="true">
          <input type="text" name="b_174f78659f6d3dd707f265f33_daaddd52e4" tabindex="-1" value="" aria-hidden="true">
        </div>
        <button type="submit" class="btn btn-primary join-item" aria-describedby="newsletter-help">
          Subscribe
        </button>
      </div>
      <div id="newsletter-help" class="text-xs text-base-content/60 mt-2">
        Get updates on web development and technology trends. Unsubscribe anytime.
      </div>
      <div id="newsletter-error" class="text-xs text-error mt-2 hidden" role="alert" aria-live="polite"></div>
    </fieldset>
  </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.querySelector('form[action*="newsletter"]');
  const emailInput = document.getElementById('newsletter-email');
  const errorDiv = document.getElementById('newsletter-error');

  if (form && emailInput && errorDiv) {
    form.addEventListener('submit', function(e) {
      // Basic client-side validation
      if (!emailInput.value || !emailInput.validity.valid) {
        e.preventDefault();
        errorDiv.textContent = 'Please enter a valid email address.';
        errorDiv.classList.remove('hidden');
        emailInput.setAttribute('aria-invalid', 'true');
        emailInput.focus();
      } else {
        errorDiv.classList.add('hidden');
        emailInput.setAttribute('aria-invalid', 'false');
      }
    });

    // Clear error when user starts typing
    emailInput.addEventListener('input', function() {
      if (errorDiv.classList.contains('hidden') === false) {
        errorDiv.classList.add('hidden');
        emailInput.setAttribute('aria-invalid', 'false');
      }
    });
  }
});
</script>
{{ end }}

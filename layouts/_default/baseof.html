<!doctype html>
<html
  lang="{{ or site.Language.LanguageCode site.Language.Lang }}"
  dir="{{ or site.Language.LanguageDirection `ltr` }}"
  data-theme="light">
  <head>
    {{ partial "head.html" . }}
    <link rel="stylesheet" href="{{ "css/custom.css" | relURL }}">
  </head>

  <body class="relative"
    x-data="{
    themes: ['light', 'dark', 'retro', 'cyberpunk', 'halloween'],
    init() {
    let saved = localStorage.getItem('theme');
    if (!saved) {
      const now = new Date();
      const month = now.getMonth(); // 0-11, 9 is October
      if (month === 9) { // October
        saved = 'halloween';
      } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        // User prefers dark mode
        saved = 'dark';
      } else {
        // Random theme otherwise
        saved = this.themes[Math.floor(Math.random() * this.themes.length)];
      }
    }
    this.applyTheme(saved);
    },
    applyTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    },
    nextTheme() {
    const current = this.getCurrentTheme();
    const currentIndex = this.themes.indexOf(current);
    const nextIndex = (currentIndex + 1) % this.themes.length;
    const nextTheme = this.themes[nextIndex];
    this.applyTheme(nextTheme);
    localStorage.setItem('theme', nextTheme);
    },
    getCurrentTheme() {
    return document.documentElement.getAttribute('data-theme') || 'light';
    }
    }"
    x-init="init()">
    <div class="drawer">
    <input id="my-drawer-3" type="checkbox" class="drawer-toggle" />
    <div class="drawer-content flex flex-col">
      <div id="main" class="relative max-w-screen-xl mx-auto px-5">
        {{ partial "navbar.html" . }}
        <main>
          {{ block "main" . }}{{ end }}
        </main>
        <footer>
          {{ partial "footer.html" . }}
        </footer>
      </div>
    </div>
    <div class="drawer-side">
      <label for="my-drawer-3" aria-label="close sidebar" class="drawer-overlay"></label>
      <ul class="menu p-4 w-80 min-h-full bg-base-200">
        {{ range .Site.Menus.main }}
        <li>
          <a href="{{ .URL }}" class="text-base-content">{{ .Name }}</a>
        </li>
        {{ end }}
        <!-- Hardcoded Get my CV button, as it's currently disabled -->
        <li>
          <a href="#" target="_blank" class="cursor-pointer font-normal text-base-content">
            Get my CV
          </a>
        </li>
        <li>
          <button
            @click="nextTheme"
            class="p-3 rounded-lg bg-base-200 hover:bg-base-300 transition-colors border border-base-300 cursor-pointer"
            aria-label="Cycle theme">
            <i class="bx bx-palette text-xl text-base-content" aria-hidden="true"></i>
          </button>
        </li>
      </ul>
    </div>
  </div>
   </body>
</html>

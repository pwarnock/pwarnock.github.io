<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light">

    <!-- Content Security Policy removed due to GitHub Pages limitations and theme switcher conflicts -->

    {{ partial "head/page-meta.html" . }}

    {{ partial "security-headers.html" . }}

    <!-- Data-driven CDN loading -->
    {{ partial "head/cdn.html" . }}

    <!-- Performance-optimized CSS splitting -->
    {{ partial "head/css-splitting.html" . }}
</head>
<body>
    <!-- Data-driven Google Tag Manager (noscript) -->
    {{ $analyticsConfig := site.Data.cdn.analytics }}
    {{ if and (eq (getenv "HUGO_ENV") "production") $analyticsConfig.container_id }}
    <noscript><iframe src="{{ $analyticsConfig.base_url }}/ns.html?id={{ $analyticsConfig.container_id }}"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        {{ end }}

    <!-- Skip to main content link for keyboard users -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-primary text-primary-content rounded-md z-50 focus:outline-none focus:ring-2 focus:ring-primary-focus" style="padding: var(--space-2) var(--space-4)" onclick="event.preventDefault(); document.getElementById('main-content').focus();">
        Skip to main content
    </a>

    {{ partial "header.html" . }}

    <!-- Hero Sections for Section Pages and Single Posts (outside main) -->
    {{ if or (and (or (eq .Type "blog") (eq .Type "portfolio") (eq .Type "tools")) (eq .Kind "section")) (and (or (eq .Type "posts") (eq .Section "blog") (eq .Type "portfolio") (eq .Type "tools")) (eq .Kind "page")) }}
      {{ if or (eq .Kind "section") (eq .Kind "page") }}
        <!-- Section page and single post: Breadcrumbs above hero -->
        {{ if not .Params.hideBreadcrumbs }}
        <div class="container mx-auto px-4 py-4">
          {{ partial "components/breadcrumbs.html" . }}
        </div>
        {{ end }}
      {{ end }}

      <!-- Hero configuration -->
      {{ $heroLayout := .Type }}
      {{ $heroBackground := "gradient-primary" }}
      {{ $heroTitle := .Title }}
      {{ $heroDescription := "" }}
      {{ $heroShowDate := false }}
      {{ $heroShowTags := false }}

      {{ if eq .Kind "section" }}
        {{ if eq .Type "blog" }}
          {{ $heroBackground = "gradient-br" }}
        {{ else if eq .Type "portfolio" }}
          {{ $heroBackground = "gradient-subtle" }}
        {{ else if eq .Type "tools" }}
          {{ $heroBackground = "gradient-primary" }}
        {{ end }}
      {{ else if eq .Kind "page" }}
        <!-- Single post/page hero configuration -->
        {{ if or (eq .Type "posts") (eq .Section "blog") }}
          {{ $heroBackground = "gradient-br" }}
          {{ $heroShowDate = true }}
          {{ $heroShowTags = true }}
          {{ $heroDescription = .Description }}
          {{ $heroLayout = "blog" }}
        {{ else if eq .Type "portfolio" }}
          {{ $heroBackground = "gradient-subtle" }}
          {{ $heroShowDate = true }}
          {{ $heroShowTags = true }}
          {{ $heroDescription = .Description }}
        {{ else if eq .Type "tools" }}
          {{ $heroBackground = "gradient-primary" }}
          {{ $heroShowDate = true }}
          {{ $heroShowTags = true }}
          {{ $heroDescription = .Description }}
        {{ end }}
      {{ end }}

      {{ partial "components/hero" (dict
        "context" .
        "size" "full"
        "background" $heroBackground
        "title" $heroTitle
        "description" $heroDescription
        "layout" $heroLayout
        "showDate" $heroShowDate
        "showTags" $heroShowTags
        "isSingle" (eq .Kind "page")
      ) }}
    {{ end }}

    <main id="main-content" class="flex-grow {{ if .IsHome }}{{ else if eq .Layout "about" }}{{ else }}container mx-auto{{ end }}" style="{{ if and (not .IsHome) (ne .Layout "about") }}padding: var(--space-8) var(--space-4){{ end }}" role="main" tabindex="-1">
        {{ block "main" . }}
        {{ if .IsHome }}
            {{ .Content }}
        {{ else }}
            <!-- Global breadcrumbs for pages without heroes -->
            {{ if and (not .Params.hideBreadcrumbs) (ne .Kind "home") (not (or (and (or (eq .Type "blog") (eq .Type "portfolio") (eq .Type "tools")) (eq .Kind "section")) (and (or (eq .Type "posts") (eq .Section "blog") (eq .Type "portfolio") (eq .Type "tools")) (eq .Kind "page")))) }}
            <div class="breadcrumbs text-sm" style="margin-bottom: var(--space-6)">
                {{ partial "components/breadcrumbs.html" . }}
            </div>
            {{ end }}

            <!-- Page content -->
            <div class="max-w-none">
                {{ block "content" . }}
                    <div class="prose prose-lg max-w-none">
                        <h1 class="text-3xl lg:text-4xl font-bold" style="margin-bottom: var(--space-6)">{{ .Title }}</h1>
                        {{ .Content }}
                    </div>
                {{ end }}
            </div>
        {{ end }}
        {{ end }}
    </main>

    {{ partial "footer.html" . }}
</body>
</html>

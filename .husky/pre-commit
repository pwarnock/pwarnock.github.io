#!/bin/bash

# Pre-Commit Hook: Quality Gates
# 
# This hook:
# 1. Runs linting and validation
# 2. Prevents commit if quality gates fail

set -e

echo ""
echo "üîç Running pre-commit checks..."
echo ""

# ============================================================================
# STEP 1: Run linting (source CSS only, not generated)
# ============================================================================

echo ""
echo "üé® Linting CSS..."
if ! bun run lint 2>/dev/null; then
  echo "‚ùå CSS linting failed"
  exit 1
fi

echo "‚úÖ Linting passed"

# ============================================================================
# STEP 2: Validation
# ============================================================================

echo ""
echo "‚úîÔ∏è  Validating files..."
if ! bun run validate 2>/dev/null; then
  echo "‚ùå Validation failed"
  exit 1
fi

echo "‚úÖ Validation passed"

# ============================================================================
# STEP 3: Test build (quick smoke test)
# ============================================================================

echo ""
echo "üî® Testing build..."
if ! hugo --quiet 2>/dev/null; then
  echo "‚ùå Build failed"
  exit 1
fi

echo "‚úÖ Build test passed"

# ============================================================================
# SUMMARY
# ============================================================================

echo ""
echo "‚úÖ All pre-commit checks passed!"
echo ""
